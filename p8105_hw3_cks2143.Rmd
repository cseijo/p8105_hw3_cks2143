---
title: "Homework 3"
author: Chariz Seijo
output: github_document
---

Solution to HW 3. 

```{r setup, include=FALSE}
library(tidyverse)
library(p8105.datasets)
```

## Problem 1

```{r}
data("instacart")
```

This dataset contains `r nrow(instacart)` rows and `r ncol(instacart)` columns.

Observations are the levels of items in orders by user. There are user/order variables, such as user ID, order ID, order day, and order hour. There are also item variables, including name, aisle, department, and some numeric codes.

**How many aisles, and which are most items from?**

```{r}
instacart %>% 
  count(aisle) %>% 
  arrange(desc(n))
```

**Make a plot!**

```{r}
instacart %>% 
  count(aisle) %>% 
  filter(n > 10000) %>% 
  mutate(
    aisle = factor(aisle),
    aisle = fct_reorder(aisle, n)
  ) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

**Make a table!**

```{r}
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle) %>%
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  filter(rank < 4) %>% 
  arrange(aisle, rank) %>% 
  knitr::kable()
```

**Apples vs. ice cream!**

```{r}
instacart %>% 
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>% 
  group_by(product_name, order_dow) %>% 
  summarize(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  ) %>% 
  knitr::kable()
```


## Problem 2

**Load, tidy, and wrangle the accelerometer data.**

```{r}
accel_df = 
  read_csv(
      "./data/accel_data.csv") %>%
  pivot_longer(
    activity.1:activity.1440,
    names_to = "minute",
    names_prefix = "activity.",
    values_to = "activity_counts"
  ) %>% 
  mutate(
    day = factor(day, 
                 levels=c("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday")),
    minute = as.numeric(minute),
    weekday = 
      ifelse(day %in% c("Saturday", "Sunday"), FALSE, TRUE)
  ) %>% 
  arrange(day)
```

This dataset includes five weeks of accelerometer data collected on a 63 year-old male who was diagnosed with congestive heart failure. It contains `r nrow(accel_df)` observations and `r ncol(accel_df)` variables. Variables in this dataset include week of observation, each day of observation, day of the week, minute of the day, activity counts, and whether each observation happened on a weekday or weekend. 

**Total activity by day**

```{r}
accel_df %>% 
  group_by(week, day) %>% 
  summarize(total_activity = sum(activity_counts)) %>%
  knitr::kable()
```

This man appears to have noticeable dips in activity on the last two Saturdays of observation. Activity counts also seem to be steady throughout the week and fluctuate more often at the end of the week.

**Plot of total activity by day**

```{r}
accel_df %>% 
 ggplot(aes(x = minute, y = activity_counts)) +
  geom_line(aes(color = day), alpha = .5)
```

Based on this graph, we can conclude that there is noticeably less activity during the night, and more activity during the day, with more spikes recorded in the morning/evening.

## Problem 3

```{r}
data("ny_noaa")
```

Data cleaning (count, etc.)

2-panel plot (org data first - group by station, year, month + summarize; filter january and july; then plot)

2-panel plot (make each plot, then figure out how to merge; first plot - contour plot or bin plot; second plot - filter first, box plot or ridge plot)